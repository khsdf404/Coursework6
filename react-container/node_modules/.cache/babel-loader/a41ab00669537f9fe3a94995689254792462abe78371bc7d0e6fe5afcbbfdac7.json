{"ast":null,"code":"import { LocalStorage } from './LocalStorage';\nconst WEB_URL = 'http://localhost:3000';\nconst API_URL = 'http://localhost:8080';\nclass ReplyDB {\n  static async GetReply(link) {\n    let obj = {};\n    let reply = await ReplyDB.Request(`${API_URL}/api/reply/${link}/`);\n    obj['answers'] = reply.answers;\n    obj['pollLink'] = reply.pollLink;\n    let poll = await ReplyDB.Request(`${API_URL}/api/polls/public/${reply.pollLink}/`, 'GET', null, LocalStorage.GetToken());\n    obj['questions'] = poll.questions;\n    try {\n      poll = await ReplyDB.Request(`${API_URL}/api/polls/private/${reply.pollLink}/`, 'GET', null, LocalStorage.GetToken());\n      obj['rightAnswers'] = poll.answers;\n    } catch (e) {\n      obj['rightAnswers'] = null;\n    }\n    ;\n    return obj;\n  }\n  static async GetPoll(link) {\n    return await ReplyDB.Request(`${API_URL}/api/polls/public/${link}/`);\n  }\n  static async PostReply(obj) {\n    return await ReplyDB.Request(`${API_URL}/api/reply/`, 'POST', obj);\n  }\n  static async GetReplyList(link) {\n    // await ReplyDB.CheckToken();\n    return await ReplyDB.Request(`${API_URL}/api/reply/byParent/${link}/`, 'GET', null, LocalStorage.GetToken());\n  }\n  static async CheckToken() {\n    let tokenObj = await ReplyDB.Request('/auth/token/', 'GET', null, LocalStorage.GetToken());\n    if (tokenObj['token'] == null) {\n      window.location.replace('/');\n      return;\n    }\n    LocalStorage.SetToken(tokenObj['token']);\n  }\n  static async Request(url, method = 'GET', bodyObj = null, token = null) {\n    let result = null;\n    let obj = {};\n    obj['method'] = method;\n    obj['headers'] = {};\n    obj['headers']['Content-type'] = 'application/json';\n    if (token) obj['headers']['Authorization'] = `Bearer ${token}`;\n    if (bodyObj) obj['body'] = JSON.stringify(bodyObj);\n    await fetch(url, obj).then(async response => {\n      console.log(response);\n      if (response.ok) await response.json().then(data => {\n        console.log(data);\n        result = data;\n      });else response.text().then(console.log);\n    });\n    return result;\n  }\n}\nexport { ReplyDB };","map":{"version":3,"names":["LocalStorage","WEB_URL","API_URL","ReplyDB","GetReply","link","obj","reply","Request","answers","pollLink","poll","GetToken","questions","e","GetPoll","PostReply","GetReplyList","CheckToken","tokenObj","window","location","replace","SetToken","url","method","bodyObj","token","result","JSON","stringify","fetch","then","response","console","log","ok","json","data","text"],"sources":["/react-container/src/hooks/ReplyDB.js"],"sourcesContent":["import { LocalStorage } from './LocalStorage';\r\n\r\nconst WEB_URL = 'http://localhost:3000';\r\nconst API_URL = 'http://localhost:8080';\r\n\r\nclass ReplyDB {\r\n\r\n    static async GetReply(link) {\r\n        let obj = {};\r\n\r\n        let reply = await ReplyDB.Request(`${API_URL}/api/reply/${link}/`);\r\n        obj['answers'] = reply.answers;\r\n        obj['pollLink'] = reply.pollLink;\r\n\r\n        let poll = await ReplyDB.Request(`${API_URL}/api/polls/public/${reply.pollLink}/`, 'GET', null, LocalStorage.GetToken());\r\n        obj['questions'] = poll.questions;\r\n\r\n        try {\r\n            poll = await ReplyDB.Request(`${API_URL}/api/polls/private/${reply.pollLink}/`, 'GET', null, LocalStorage.GetToken());\r\n            obj['rightAnswers'] = poll.answers;\r\n        } catch (e) {\r\n            obj['rightAnswers'] = null;\r\n        };\r\n\r\n        return obj;\r\n    }\r\n\r\n    static async GetPoll(link) {\r\n        return await ReplyDB.Request(`${API_URL}/api/polls/public/${link}/`);\r\n    }\r\n\r\n    static async PostReply(obj) {\r\n        return await ReplyDB.Request(`${API_URL}/api/reply/`, 'POST', obj);\r\n    }\r\n\r\n    static async GetReplyList(link) {\r\n        // await ReplyDB.CheckToken();\r\n        return await ReplyDB.Request(`${API_URL}/api/reply/byParent/${link}/`, 'GET', null, LocalStorage.GetToken())\r\n    }\r\n\r\n    \r\n\r\n    static async CheckToken() {\r\n        let tokenObj = await ReplyDB.Request('/auth/token/', 'GET', null, LocalStorage.GetToken());\r\n        if (tokenObj['token'] == null) {\r\n            window.location.replace('/');\r\n            return;\r\n        }\r\n        LocalStorage.SetToken(tokenObj['token']);\r\n    }\r\n    \r\n    static async Request(url, method = 'GET', bodyObj = null, token = null) {\r\n        \r\n        let result = null;\r\n        let obj = {};\r\n\r\n        obj['method'] = method;\r\n        \r\n        obj['headers'] = {};\r\n        obj['headers']['Content-type'] = 'application/json';\r\n        if (token) obj['headers']['Authorization'] = `Bearer ${token}`;\r\n            \r\n        if (bodyObj) obj['body'] = JSON.stringify(bodyObj);\r\n        \r\n        await fetch(url, obj).then(async (response) => {\r\n            console.log(response)\r\n            if (response.ok)\r\n                await response.json().then(data => {\r\n                    console.log(data);\r\n                    result = data;\r\n                })\r\n            else \r\n                response.text().then(console.log)\r\n        });\r\n\r\n        return result;\r\n    }\r\n} \r\n\r\nexport { ReplyDB };"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}